import mail from '@sendgrid/mail';
import { NextApiRequest, NextApiResponse } from 'next';

mail.setApiKey(`SG.c7vSz__eSCCET77wQTsiIg.xridvcZHoEv0Q00SeWaSTsJu5E0BMZF-wPW--d1_gCs`);

// eslint-disable-next-line import/no-anonymous-default-export
export default async (req: NextApiRequest, res: NextApiResponse) => {
    const body = req.body;

    const message = `
    Name: ${body.name}\r\n
    Email: ${body.email}\r\n
  `;

  const fileDoc = `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`

    const data = {
        to: body.email,
        from: 'bizler.group@gmail.com',
        subject: `Коммерческий лист от New Era для ${body.name}`,
        text: message,
        html: message.replace(/\r\n/g, '<br />'),
        attachments: [
            {
              content: fileDoc,
              filename: 'list.docx',
              type: 'application/msword',
              disposition: 'attachment',
              content_id: 'mytext',
            },
          ],
    };

    await mail.send(data).then(() => {
        console.log('Email sent')
        res.status(200).json({ status: 'OK' });
    })
        .catch((error) => {
            console.error(error)
            res.status(400).json({ message: error });
        });
};
